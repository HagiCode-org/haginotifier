# Implementation Tasks

## 1. 修改 action.yml 中的 JSON 解析逻辑
- [ ] 1.1 打开 `action.yml` 文件，定位到第 52-59 行的 "Run notification" 步骤
- [ ] 1.2 添加 `set +e` 命令以防止命令失败时立即退出
- [ ] 1.3 捕获 CLI 执行的退出代码，用于错误处理
- [ ] 1.4 实现优先使用 `jq` 的 JSON 解析逻辑
- [ ] 1.5 实现使用 Node.js 的回退解析逻辑
- [ ] 1.6 添加 CLI 执行失败时的默认值设置

## 2. 代码验证
- [ ] 2.1 确认 YAML 语法正确（缩进、格式）
- [ ] 2.2 确认 `GITHUB_OUTPUT` 写入逻辑完整
- [ ] 2.3 确认 `HAGI_ACTION_MODE` 环境变量传递正确
- [ ] 2.4 验证错误处理路径覆盖所有失败场景

## 3. 测试验证
- [ ] 3.1 提交并推送修改到远程仓库
- [ ] 3.2 在 GitHub Actions 页面手动触发 "Test Notification" 工作流
- [ ] 3.3 验证正常通知场景（成功发送消息）
- [ ] 3.4 验证错误通知场景（使用无效 webhook URL）
- [ ] 3.5 验证响应包含特殊字符的场景
- [ ] 3.6 检查飞书群聊是否收到测试消息
- [ ] 3.7 查看 GitHub Step Summary 中的输出参数

## 4. 边界条件测试
- [ ] 4.1 测试响应包含换行符的场景
- [ ] 4.2 测试响应包含引号的场景
- [ ] 4.3 测试响应包含复杂 JSON 的场景
- [ ] 4.4 测试 CLI 执行异常退出的场景
- [ ] 4.5 验证所有场景下工作流都以 exit code 0 完成（当 HAGI_ACTION_MODE=true）
